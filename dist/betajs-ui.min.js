/*!
betajs-ui - v1.0.37 - 2017-04-21
Copyright (c) Victor Lingenthal,Oliver Friedmann
Apache-2.0 Software License.
*/
var Scoped=function(){function a(a){function b(a){return{route:"string"==typeof a.route?a.route:null,parent:"object"==typeof a.parent?a.parent:null,ready:"boolean"==typeof a.ready?a.ready:!1,children:{},watchers:[],data:{},lazy:[]}}function c(a){if(!a.ready){if(a.parent&&!a.parent.ready)return void c(a.parent);if(a.route&&a.parent&&a.route in a.parent.data){a.data=a.parent.data[a.route],a.ready=!0;for(var b=0;b<a.watchers.length;++b)a.watchers[b].callback.call(a.watchers[b].context||this,a.data);a.watchers=[];for(var d in a.children)c(a.children[d])}}}function d(a){if(!a.ready){a.parent&&!a.parent.ready&&d(a.parent),a.ready=!0,a.parent&&j.tree&&"object"==typeof a.parent.data&&(a.parent.data[a.route]=a.data);for(var b=0;b<a.watchers.length;++b)a.watchers[b].callback.call(a.watchers[b].context||this,a.data);a.watchers=[]}}function e(a,b){if("object"==typeof b&&a.ready)for(var e in b)a.data[e]=b[e];else a.data=b;if("object"==typeof b)for(var f in b)a.children[f]&&(a.children[f].data=b[f]);d(a);for(var g in a.children)c(a.children[g])}function f(a){if(a.ready&&a.data)for(var b in a.data)delete a.data[b]}function g(a){if(!a)return k;for(var d=a.split("."),e=k,f=0;f<d.length;++f)d[f]in e.children?e=e.children[d[f]]:(e.children[d[f]]=b({parent:e,route:d[f]}),e=e.children[d[f]],c(e));return e}function h(a,b,c){if(a.ready)b.call(c||this,a.data);else if(a.watchers.push({callback:b,context:c}),a.lazy.length>0){var d=function(a){if(a.lazy.length>0){var b=a.lazy.shift();b.callback.call(b.context||this,a.data),d(a)}};d(a)}}function i(a,b,c){a=a||k,c=c||[],a.ready||c.push(b);for(var d in a.children){var e=a.children[d],f=(b?b+".":"")+e.route;c=i(e,f,c)}return c}var j={tree:"boolean"==typeof a.tree?a.tree:!1,global:"boolean"==typeof a.global?a.global:!1,root:"object"==typeof a.root?a.root:{}},k=b({ready:!0});if(j.tree)if(j.global){try{window&&(k.data=window)}catch(l){}try{global&&(k.data=global)}catch(l){}try{self&&(k.data=self)}catch(l){}}else k.data=j.root;return{extend:function(a,b){e(g(a),b)},set:function(a,b){var c=g(a);c.data&&f(c),e(c,b)},get:function(a){var b=g(a);return b.ready?b.data:null},lazy:function(a,b,c){var d=g(a);d.ready?b(c||this,d.data):d.lazy.push({callback:b,context:c})},digest:function(a){c(g(a))},obtain:function(a,b,c){h(g(a),b,c)},unresolvedWatchers:function(a){return i(g(a),a)},__export:function(){return{options:j,nsRoot:k}},__import:function(a){j=a.options,k=a.nsRoot}}}function b(e,f,g,h){var i=null,j=[],k=f,l=g,m=h,n=a({tree:!0}),o=a({tree:!1}),p={global:{namespace:m},root:{namespace:l},local:{namespace:n},"default":{namespace:o},parent:{namespace:k},scope:{namespace:n,readonly:!1}},q=function(a,b,c){var e=d.matchArgs(a,{options:"object",namespaceLocator:!0,dependencies:"array",hiddenDependencies:"array",callback:!0,context:"object"}),f=d.extend({lazy:this.options.lazy},e.options||{}),g=this.resolve(e.namespaceLocator),h=function(){this.require(e.dependencies,e.hiddenDependencies,function(){if(arguments[arguments.length-1].ns=g,this.options.compile){for(var f=[],h=0;h<a.length;++h)f.push(d.stringify(a[h]));this.compiled+=this.options.ident+"."+b+"("+f.join(", ")+");\n\n"}this.options.dependencies&&(this.dependencies[g.path]=this.dependencies[g.path]||{},e.dependencies&&e.dependencies.forEach(function(a){this.dependencies[g.path][this.resolve(a).path]=!0},this),e.hiddenDependencies&&e.hiddenDependencies.forEach(function(a){this.dependencies[g.path][this.resolve(a).path]=!0},this));var i=this.options.compile?{}:e.callback.apply(e.context||this,arguments);c.call(this,g,i)},this)};return f.lazy?g.namespace.lazy(g.path,h,this):h.apply(this),this};return{getGlobal:d.method(c,c.getPath),setGlobal:d.method(c,c.setPath),options:{lazy:!1,ident:"Scoped",compile:!1,dependencies:!1},compiled:"",dependencies:{},nextScope:function(){return i||(i=b(this,n,l,m)),i},subScope:function(){var a=this.nextScope();return j.push(a),i=null,a},binding:function(b,c,e){if(!p[b]||!p[b].readonly){var f;f="string"!=d.typeOf(c)?{namespace:a({tree:!0,root:c}),path:null}:this.resolve(c),p[b]=d.extend(e,f)}return this},resolve:function(a){var b=a.split(":");if(1==b.length)return{namespace:o,path:b[0]};var c=p[b[0]];if(!c)throw"The namespace '"+b[0]+"' has not been defined (yet).";return{namespace:c.namespace,path:c.path&&b[1]?c.path+"."+b[1]:c.path||b[1]}},define:function(){return q.call(this,arguments,"define",function(a,b){if(a.namespace.get(a.path))throw"Scoped namespace "+a.path+" has already been defined. Use extend to extend an existing namespace instead";a.namespace.set(a.path,b)})},assumeVersion:function(){var a=d.matchArgs(arguments,{assumption:!0,dependencies:"array",callback:!0,context:"object",error:"string"}),b=a.dependencies||[];b.unshift(a.assumption),this.require(b,function(){var b=arguments,c=b[0].replace(/[^\d\.]/g,"");b[0]=c.split(".");for(var e=0;e<b[0].length;++e)b[0][e]=parseInt(b[0][e],10);if("function"===d.typeOf(a.callback)){if(!a.callback.apply(a.context||this,a))throw"Scoped Assumption '"+a.assumption+"' failed, value is "+c+(a.error?", but assuming "+a.error:"")}else for(var f=(a.callback+"").replace(/[^\d\.]/g,"").split("."),g=0;g<Math.min(b[0].length,f.length);++g)if(parseInt(f[g],10)>b[0][g])throw"Scoped Version Assumption '"+a.assumption+"' failed, value is "+c+", but assuming at least "+a.callback})},extend:function(){return q.call(this,arguments,"extend",function(a,b){a.namespace.extend(a.path,b)})},require:function(){var a=d.matchArgs(arguments,{dependencies:"array",hiddenDependencies:"array",callback:"function",context:"object"});a.callback=a.callback||function(){};var b=a.dependencies||[],c=b.concat(a.hiddenDependencies||[]),e=c.length,f=[],g={};if(e)for(var h=function(b){this.i<f.length&&(f[this.i]=b),e--,0===e&&(f.push(g),a.callback.apply(a.context||this.ctx,f))},i=0;i<c.length;++i){var j=this.resolve(c[i]);i<b.length&&f.push(null),j.namespace.obtain(j.path,h,{ctx:this,i:i})}else f.push(g),a.callback.apply(a.context||this,f);return this},digest:function(a){var b=this.resolve(a);return b.namespace.digest(b.path),this},unresolved:function(a){var b=this.resolve(a);return b.namespace.unresolvedWatchers(b.path)},__export:function(){return{parentNamespace:k.__export(),rootNamespace:l.__export(),globalNamespace:m.__export(),localNamespace:n.__export(),privateNamespace:o.__export()}},__import:function(a){k.__import(a.parentNamespace),l.__import(a.rootNamespace),m.__import(a.globalNamespace),n.__import(a.localNamespace),o.__import(a.privateNamespace)}}}var c=function(){return{get:function(a){return"undefined"!=typeof window?window[a]:"undefined"!=typeof global?global[a]:"undefined"!=typeof self?self[a]:void 0},set:function(a,b){return"undefined"!=typeof window&&(window[a]=b),"undefined"!=typeof global&&(global[a]=b),"undefined"!=typeof self&&(self[a]=b),b},getPath:function(a){var b=a.split(".");if(1==b.length)return this.get(a);for(var c=this.get(b[0]),d=1;d<b.length;++d){if(!c)return c;c=c[b[d]]}return c},setPath:function(a,b){var c=a.split(".");if(1==c.length)return this.set(a,b);for(var d=this.get(c[0])||this.set(c[0],{}),e=1;e<c.length-1;++e)c[e]in d||(d[c[e]]={}),d=d[c[e]];return d[c[c.length-1]]=b,b}}}.call(this),d=function(){return{method:function(a,b){return function(){return b.apply(a,arguments)}},extend:function(a,b){a=a||{},b=b||{};for(var c in b)a[c]=b[c];return a},typeOf:function(a){return"[object Array]"===Object.prototype.toString.call(a)?"array":typeof a},isEmpty:function(a){if(null===a||"undefined"==typeof a)return!0;if("array"==this.typeOf(a))return 0===a.length;if("object"!=typeof a)return!1;for(var b in a)return!1;return!0},matchArgs:function(a,b){var c=0,d={};for(var e in b)b[e]===!0||this.typeOf(a[c])==b[e]?(d[e]=a[c],c++):"undefined"==this.typeOf(a[c])&&c++;return d},stringify:function(a){return"function"==this.typeOf(a)?""+a:JSON.stringify(a)}}}.call(this),e=function(){return{__namespace:"Scoped",__revert:null,upgrade:function(a){var b=c.get(a||e.__namespace);if(b&&"object"==d.typeOf(b)&&b.guid==this.guid&&"string"==d.typeOf(b.version)){for(var f=this.version.split("."),g=b.version.split("."),h=!1,i=0;i<Math.min(f.length,g.length)&&(h=parseInt(f[i],10)>parseInt(g[i],10),f[i]==g[i]);++i);return h?this.attach(a):b}return this.attach(a)},attach:function(a){a&&(e.__namespace=a);var b=c.get(e.__namespace);if(b==this)return this;if(e.__revert=b,b)try{var d=b.__exportScoped();this.__exportBackup=this.__exportScoped(),this.__importScoped(d)}catch(f){}return c.set(e.__namespace,this),this},detach:function(a){return a&&c.set(e.__namespace,null),"undefined"!=typeof e.__revert&&c.set(e.__namespace,e.__revert),delete e.__revert,e.__exportBackup&&this.__importScoped(e.__exportBackup),this},exports:function(a,b,c){return a=a||("undefined"!=typeof module?module:null),"object"==typeof a&&a&&"exports"in a&&(c||a.exports==this||!a.exports||d.isEmpty(a.exports))&&(a.exports=b||this),this}}}.call(this),f=a({tree:!0,global:!0}),g=a({tree:!0}),h=b(null,g,g,f),i=d.extend(h,function(){return{guid:"4b6878ee-cb6a-46b3-94ac-27d91f58d666",version:"0.0.13",upgrade:e.upgrade,attach:e.attach,detach:e.detach,exports:e.exports,__exportScoped:function(){return{globalNamespace:f.__export(),rootNamespace:g.__export(),rootScope:h.__export()}},__importScoped:function(a){f.__import(a.globalNamespace),g.__import(a.rootNamespace),h.__import(a.rootScope)}}}.call(this));return i=i.upgrade(),i.exports(),i}.call(this);(function(){var a=this.subScope();a.binding("module","global:BetaJS.UI"),a.binding("base","global:BetaJS"),a.binding("browser","global:BetaJS.Browser"),a.binding("dynamics","global:BetaJS.Dynamics"),a.define("module:",function(){return{guid:"ff8d5222-1ae4-4719-b842-1dedb9162bc0",version:"1.0.37"}}),a.assumeVersion("base:version","~1.0.96"),a.assumeVersion("browser:version","~1.0.62"),a.define("module:Dynamics.GesturePartial",["dynamics:Handlers.Partial","module:Gestures.Gesture","module:Gestures","base:Objs"],["module:Gestures.defaultGesture"],function(a,b,c,d,e){var f=a.extend({scoped:e},function(a){return{_apply:function(a){var e=this._node,f=e._handler;if(e.gestures=e.gestures||{},!(this._postfix in e.gestures)||e.gestures[this._postfix].destroyed()){a=d.extend(a,a.options);var g=this._node.element(),h=new b(g,c.defaultGesture(a));e.gestures[this._postfix]=h,h.on("activate",function(){a.activate_event&&f.call(a.activate_event,a.data,this._node,h),a.interaction&&e.interactions&&e.interactions[a.interaction]&&e.interactions[a.interaction].start&&e.interactions[a.interaction].start()},this),h.on("deactivate",function(){a.deactivate_event&&f.call(a.deactivate_event,a.data,this._node,h),a.interaction&&e.interactions&&e.interactions[a.interaction]&&e.interactions[a.interaction].stop&&e.interactions[a.interaction].stop()},this),a.transition_event&&h.on("start",function(){f.call(a.transition_event,g,h)},this)}},_deactivate:function(){this.__release()},__release:function(){var a=this._node;a.gestures=a.gestures||{},this._postfix in a.gestures&&a.gestures[this._postfix].weakDestroy(),delete a.gestures[this._postfix]},destroy:function(){this.__release(),a.destroy.call(this)}}});return f.register("ba-gesture"),f}),a.define("module:Dynamics.InteractionPartial",["dynamics:Handlers.Partial","module:Interactions","base:Strings","base:Objs","base:Types"],function(a,b,c,d,e,f){var g=a.extend({scoped:f},function(a){return{_apply:function(a){var f=this._node,g=f._handler;if(f.interactions=f.interactions||{},this._postfix in f.interactions&&!f.interactions[this._postfix].destroyed())return void(f.interactions[this._postfix].data=a.data);a=d.extend(a,a.options);var h=b[c.capitalize(a.type)],i=a.sub?this._node.element().querySelector(a.sub):this._node.element(),j=a.items?this._node.element().querySelector(a.items):void 0,k=new h(i,d.extend({enabled:!0,context:g,itemsElement:j},a),a.data);f.interactions[this._postfix]=k,d.iter(a.events,function(a,b){k.on(b,function(b,c,d,f){e.is_string(a)?g.call(a,this._value.data,b,c,d,f):a.call(g,this._value.data,b,c,d,f)},this)},this)},_deactivate:function(){this.__release()},__release:function(){var a=this._node;a.interactions=a.interactions||{},this._postfix in a.interactions&&a.interactions[this._postfix].weakDestroy()},destroy:function(){this.__release(),a.destroy.call(this)}}});return g.register("ba-interaction"),g}),a.define("module:Elements.Animators",["base:Class","base:Objs","browser:Dom"],function(a,b,c,d){return a.extend({scoped:d},function(a){return{constructor:function(d,e,f,g){a.constructor.call(this),this._element=c.unbox(d),this._options=b.extend({callback_on_revert:!0,callback_on_complete:!0,auto_start:!0,auto_destroy:!0},e),this._callback=f,this._context=g,this._running=!1,this._options.auto_start&&this.start()},start:function(){this._running||(this._running=!0,this._start())},revert:function(){this._running&&(this._running=!1,this._revert())},complete:function(){this._running&&this._complete()},__callback:function(){this.destroyed()||(this._callback.apply(this._context||this),this._options&&this._options.auto_destroy&&this.destroy())},_finished:function(){this.__callback()},_reverted:function(){this._options.callback_on_revert&&this.__callback()},_completed:function(){this._options.callback_on_complete&&this.__callback()},_start:function(){this._finished()},_revert:function(){this._reverted()},_complete:function(){this._completed()}}})}),a.define("module:Elements.DefaultAnimator",["module:Elements.Animators","base:Objs","base:Types","base:Timers.Timer"],function(a,b,c,d,e){return a.extend({scoped:e},function(a){var e={linear:function(a){return a},swing:function(a){return Math.sin(a*Math.PI/2)}};return{constructor:function(f,g,h,i){g=b.extend({duration:250,delay:10,styles:{},method:"swing"},g),c.is_string(g.method)&&(g.method=e[g.method]||e.linear),this.__timer=this.auto_destroy(new d({delay:g.delay,start:!1,context:this,fire:this.__fire})),a.constructor.call(this,f,g,h,i)},__setProgress:function(a){a=Math.max(0,Math.min(1,a)),b.iter(this.__styles,function(b,c){b.target[c]=Math.round(b.start+(b.end-b.start)*a)+b.postfix},this)},__fire:function(){this.__setProgress(this._options.method(this.__timer.duration()/this._options.duration)),this.__timer.duration()>=this._options.duration&&this._complete()},_start:function(){this.__completed=!1,this.__timer.stop(),this.__styles=b.map(this._options.styles,function(a,b){var d=b in this._element?this._element:this._element.style;return{target:d,start:parseFloat(d[b]),end:parseFloat(a),postfix:c.is_string(a)?a.replace(/[\d\.]/g,""):""}},this),this.__timer.start()},_revert:function(){this.__timer.stop(),this.__setProgress(0),this._reverted()},_complete:function(){this.__completed||(this.__completed=!0,this.__setProgress(1),this.__timer.stop(),this._completed())}}})}),a.define("module:Elements.ElementModifier",["base:Class","browser:Dom"],function(a,b,c){return a.extend({scoped:c},function(a){return{constructor:function(c){a.constructor.call(this),this._element=b.unbox(c),this._css={},this._cls={}},css:function(a,b){return arguments.length<2?this._element.style[a]:this._element.style[a]===b?b:(a in this._css||(this._css[a]=this._element.style[a]),this._element.style[a]=b,b)},csscls:function(a,c){var d=b.elementHasClass(this._element,a);return arguments.length<2?a:d===c?c:(a in this._cls||(this._cls[a]=d),c?b.elementAddClass(this._element,a):b.elementRemoveClass(this._element,a),c)},removeClass:function(a){b.elementHasClass(this._element,a)&&(a in this._cls||(this._cls[a]=!0),b.elementAddClass(this._element,a))},revert:function(){for(var a in this._css)this._element.style[a]=this._css[a];for(a in this._cls)this._cls[a]?b.elementAddClass(this._element,a):b.elementRemoveClass(this._element,a)}}})}),a.define("module:Events.Mouse",["browser:Info"],function(a){return{downEvent:function(){return a.isMobile()?"touchstart":"mousedown"},moveEvent:function(){return a.isMobile()?"touchmove":"mousemove"},upEvent:function(){return a.isMobile()?"touchend":"mouseup"},clickEvent:function(){return a.isMobile()?"touchstart":"click"},customCoords:function(a,b,c){if(a.touches&&a.touches.length){var d=a.touches;if(c){for(var e=[],f=0;f<d.length;++f)e.push({x:d[f][b+"X"],y:d[f][b+"Y"]});return e}return{x:d[0][b+"X"],y:d[0][b+"Y"]}}var g={x:a[b+"X"],y:a[b+"Y"]};return c?[g]:g},pageCoords:function(a,b){return this.customCoords(a,"page",b)},clientCoords:function(a,b){return this.customCoords(a,"client",b)},screenCoords:function(a,b){return this.customCoords(a,"screen",b)}}}),a.define("module:Events.Support",["base:Objs","base:Types","browser:Dom"],function(a,b,c){return{dispatchElementEvent:function(b,c,d,e){b.dispatchEvent(new CustomEvent(c,a.extend({bubbles:!0,cancelable:!0,detail:d},e)))},dispatchElementsEvent:function(b,c,d,e){for(var f=0;f<b.length;++f)b[f].dispatchEvent(new CustomEvent(c,a.extend({bubbles:!1,cancelable:!0,detail:d},e)))},dispatchManualBubbleEvent:function(a,b,d,e,f){for(var g=[],h=c.unbox(a);h;)d(h)&&g.push(h),h=h.parentNode;this.dispatchElementsEvent(g,b,e,f)},dispatchPointsSeparatorEvent:function(a,d,e,f,g,h){e=e?b.is_array(e)?e:[e]:[],f=f?b.is_array(f)?f:[f]:[],this.dispatchManualBubbleEvent(a,d,function(a){for(var b=0;b<e.length;++b)if(!c.pointWithinElement(e[b].x,e[b].y,a))return!1;for(b=0;b<f.length;++b)if(c.pointWithinElement(f[b].x,f[b].y,a))return!1;return!0},g,h)}}}),a.define("module:Gestures.ElementStateHost",["base:States.CompetingHost","module:Gestures.GestureStates","base:Classes.ClassRegistry","browser:Dom"],function(a,b,c,d,e){return a.extend({scoped:e},function(a){return{constructor:function(e,f){a.constructor.call(this,f,{stateRegistry:new c(b)}),this._element=d.unbox(e)},element:function(){return this._element}}})}),a.define("module:Gestures.Gesture",["module:Gestures.ElementStateHost","base:States.CompetingComposite","base:Objs","module:Gestures.GestureStates.EventDrivenState","browser:Dom"],function(a,b,c,d,e,f){return a.extend({scoped:f},function(a){return{constructor:function(f,g){f=e.unbox(f);var h=f.gestures_handler;h||(h=new b,f.gestures_handler=h),a.constructor.call(this,f,h);for(var i in g)g[i]=c.extend({priority:1,exclusive:!1,retreat:"Retreat"},g[i]);this.initialize(d,{state_descriptor:g,current_state:"Initial"})}}})}),a.define("module:Gestures.ElementState",["base:States.CompetingState","base:Ids","base:Objs","browser:Events"],function(a,b,c,d,e){return a.extend({scoped:e},function(a){return{_persistents:["client_pos","screen_pos"],constructor:function(){a.constructor.apply(this,arguments),this._domevents=this.auto_destroy(new d)},_start:function(){a._start.call(this),this.on("mousemove touchmove",function(a){var b="mousemove"==a.type?a:a.touches[0];this._client_pos={x:b.clientX,y:b.clientY},this._screen_pos={x:b.screenX,y:b.screenY}})},element:function(){return this.host.element()},on:function(a,b){this._domevents.on(this.element(),a,function(a){b.call(this,a)},this)},_end:function(){this._domevents.clear()},trigger:function(){this.host.trigger.apply(this.host,arguments)}}})}),a.define("module:Gestures.ElementEvent",["base:Class","base:Ids","base:Objs","browser:Events","browser:Dom"],function(a,b,c,d,e,f){return a.extend({scoped:f},function(a){return{constructor:function(b,c,e){a.constructor.call(this),this._element=b,this._callback=c,this._context=e,this._domevents=this.auto_destroy(new d)},callback:function(){this._callback&&this._callback.apply(this._context,arguments)},on:function(a,b,c,d){d=e.unbox(d||this._element),a.split(" ").forEach(function(a){this._domevents.on(d,a,b,c||this)},this)}}})}),a.define("module:Gestures.ElementTriggerEvent",["module:Gestures.ElementEvent"],function(a,b){return a.extend({scoped:b},function(a){return{constructor:function(b,c,d,e){a.constructor.call(this,c,d,e),this.on(b,function(){this.callback()})}}})}),a.define("module:Gestures.BodyTriggerEvent",["module:Gestures.ElementEvent"],function(a,b){return a.extend({scoped:b},function(a){return{constructor:function(b,c,d,e){a.constructor.call(this,c,d,e),this.on(b,function(){this.callback()},this,document.body)}}})}),a.define("module:Gestures.ElementTimerEvent",["module:Gestures.ElementEvent"],function(a,b){return a.extend({scoped:b},function(a){return{constructor:function(b,c,d,e){a.constructor.call(this,c,d,e);var f=this;0>=b||(this._timer=setTimeout(function(){f.callback()},b))},destroy:function(){clearTimeout(this._timer),a.destroy.call(this)}}})}),a.define("module:Gestures.ElementScrollEvent",["module:Gestures.ElementEvent","base:Time"],function(a,b,c){return a.extend({scoped:c},function(a){return{constructor:function(b,c,d,e){a.constructor.call(this,c,d,e),this.last_scroll_event=null,this.scroll_start_event=null,this.scroll_threshold=b.threshold,this.on("scroll",this.__scroll,this,b.element)},__scroll:function(){if(!this.destroyed()){var a=b.now();if(null===this.scroll_start_event||this.last_scroll_event&&a-this.last_scroll_event>50)return this.scroll_start_event=a,void(this.last_scroll_event=a);this.last_scroll_event=a;var c=a-this.scroll_start_event;c>this.scroll_threshold&&this.callback()}}}})}),a.define("module:Gestures.ElementScrollEndEvent",["module:Gestures.ElementEvent","base:Time"],function(a,b,c){return a.extend({scoped:c},function(a){return{constructor:function(b,c,d,e){a.constructor.call(this,c,d,e),this.__fire(),this.on("scroll",this.__fire,this,b.element)},__fire:function(){if(!this.destroyed()){this.timer&&clearTimeout(this.timer);var a=this;this.timer=setTimeout(function(){a.callback()},50)}}}})}),a.define("module:Gestures.ElementMouseMoveOutEvent",["module:Gestures.ElementEvent","module:Events.Mouse"],function(a,b,c){return a.extend({scoped:c},function(a){return{constructor:function(c,d,e,f){a.constructor.call(this,d,e,f);var g={},h={x:0,y:0};this.on(b.moveEvent(),function(a){g.x||g.y||(g=b.pageCoords(a));var d=b.pageCoords(a);h.x=Math.max(h.x,Math.abs(g.x-d.x)),h.y=Math.max(h.y,Math.abs(g.y-d.y)),("x"in c&&c.x>=0&&h.x>=c.x||"y"in c&&c.y>=0&&h.y>=c.y)&&this.callback()})}}})}),a.define("module:Gestures.GestureStates.EventDrivenState",["module:Gestures.ElementState","module:Gestures"],function(a,b,c){return a.extend({scoped:c},function(a){return{_persistents:["client_pos","screen_pos","state_descriptor"],_locals:["current_state"],_state_descriptor:null,_current_state:null,current_state:function(){return this._state_descriptor[this._current_state]},description:function(){return this._current_state},nextDrivenState:function(a){this.next("EventDrivenState",{current_state:a})},_start:function(){a._start.call(this);var c=this.current_state();c.start&&c.start.apply(this),c.events=c.events||[];for(var d=function(a){this._auto_destroy(new b[a.event](a.args,this.element(),function(){this.nextDrivenState(a.target)},this))},e=0;e<c.events.length;++e)d.call(this,c.events[e])},_end:function(){var b=this.current_state();b.end&&b.end.apply(this),a._end.call(this)},can_coexist_with:function(a){return!this.current_state().exclusive&&!a.current_state().exclusive},can_prevail_against:function(a){return this.current_state().priority>a.current_state().priority},retreat_against:function(a){this.nextDrivenState(this.current_state().retreat)}}})}),a.define("module:Gestures.defaultGesture",["base:Objs","module:Events.Mouse"],["module:Gestures.ElementTriggerEvent","module:Gestures.BodyTriggerEvent","module:Gestures.ElementTimerEvent","module:Gestures.ElementScrollEvent","module:Gestures.ElementScrollEndEvent","module:Gestures.ElementMouseMoveOutEvent"],function(a,b){return function(c){return c=a.extend({mouse_up_activate:!1,wait_time:750,wait_activate:!0,disable_x:10,disable_y:10,enable_x:-1,enable_y:-1,active_priority:2,disable_scroll_element:null,disable_scroll_time:500},c),{Initial:{events:a.filter([{event:"ElementTriggerEvent",args:b.downEvent(),target:"DownState"},null===c.disable_scroll_element?null:{event:"ElementScrollEvent",args:{element:c.disable_scroll_element,threshold:c.disable_scroll_time},target:"DisableScroll"}],function(a){return!!a})},DisableScroll:{events:[{event:"ElementScrollEndEvent",args:{element:c.disable_scroll_element},target:"Initial"}]},Retreat:{start:function(){this.trigger("deactivate"),this.nextDrivenState("Initial")}},DownState:{events:a.filter([null===c.mouse_up_activate?null:{event:"BodyTriggerEvent",args:b.upEvent(),target:c.mouse_up_activate?"ActiveState":"Initial"},{event:"ElementMouseMoveOutEvent",args:{x:c.disable_x,y:c.disable_y},target:"Initial"},{event:"ElementMouseMoveOutEvent",args:{x:c.enable_x,y:c.enable_y},target:"ActiveState"},null===c.wait_activate?null:{event:"ElementTimerEvent",args:c.wait_time,target:c.wait_activate?"ActiveState":"Initial"},null===c.disable_scroll_element?null:{event:"ElementScrollEvent",args:{element:c.disable_scroll_element,threshold:c.disable_scroll_time},target:"DisableScroll"}],function(a){return!!a})},ActiveState:{priority:c.active_priority,exclusive:!0,start:function(){this.trigger("activate"),this.nextDrivenState("Initial")}}}}}),a.define("module:Hardware.MouseCoords",["base:Ids","base:Objs","browser:Events","module:Events.Mouse"],function(a,b,c,d){return{__required:0,__domevents:null,coords:{x:0,y:0},require:function(){0===this.__required&&(this.__domevents=new c,this.__domevents.on(document.body,[d.moveEvent(),d.upEvent(),d.downEvent()].join(" "),function(a){var b=d.pageCoords(a);b.x&&b.y&&(this.coords=b)},this)),this.__required++},unrequire:function(){this.__required--,0===this.__required&&this.__domevents.destroy()}}}),a.define("module:Helpers.Interactor",["base:Class","base:Objs","base:Types","base:Promise","base:Async","browser:Dom"],function(a,b,c,d,e,f,g){return a.extend({scoped:g},function(a){return{constructor:function(c){a.constructor.apply(this),this._options=b.extend({delay:1},c)},_element:function(a){return a?c.is_string(a)?document.querySelector(a):a:document.body},mousedown:function(a){return this._event(a,"mousedown")},mouseup:function(a){return this._event(a,"mouseup")},mousemoveToElement:function(a,b){a=this._element(a);var c=f.elementOffset(a),d=f.elementDimensions(a);return this._event(b,"mousemove",{pageX:c.left+d.width/2,pageY:c.top+d.height/2})},_event:function(a,b,g){var h=d.create();return a=this._element(a?c.is_string(a)?document.querySelector(a):a:document.body),e.eventually(function(){f.triggerDomEvent(a,b,g),h.asyncSuccess(a)},this._options.delay),h}}})}),a.define("module:Interactions.Drag",["module:Interactions.ElementInteraction","module:Elements.ElementModifier","browser:Dom","module:Events.Support","module:Events.Mouse","module:Hardware.MouseCoords","base:Ids","base:Objs","module:Interactions.DragStates"],["module:Interactions.DragStates.Idle","module:Interactions.DragStates.Dragging","module:Interactions.DragStates.Stopping"],function(a,b,c,d,e,f,g,h,i,j){return a.extend({scoped:j},function(a){return{constructor:function(c,d,f){d=h.extend({start_event:e.downEvent(),stop_event:e.upEvent(),draggable_x:!0,draggable_y:!0,clone_element:!1,drag_original_element:!1,droppable:!1,remove_element_on_drop:!1,revertable:!0,draggable:function(){return!0},snappable:function(a,b){return{left:a,top:b}}},d),a.constructor.call(this,c,d,i),this._host.initialize("Idle"),this._modifier=new b(this.element()),this.data=f},destroy:function(){this._modifier.revert(),this._modifier.destroy(),a.destroy.call(this)},_enable:function(){this._options.start_event&&this.__on(this.element(),this._options.start_event,this.start,this)},_disable:function(){this._domEvents.clear(),this.stop()},start:function(){this._enabled&&this._host.state().next("Dragging")},stop:function(){this._enabled&&this._host.state().next("Stopping")},draggable:function(){return this._options.draggable.call(this._options.context,this)},abort:function(){this._enabled&&this._host.state().next("Idle")},dropped:function(a){this.trigger("dropped",a),this._host.state().next("Stopping",{immediately:!0}),this._options.remove_element_on_drop&&(this.element().parentNode.removeChild(this.element()),this.destroy())},actionable_element:function(){return this._host.state()._cloned_element||this.element()},modifier:function(){return this._modifier},actionable_modifier:function(){var a=this._host.state()._cloned_modifier;return a?a:this._modifier},__eventData:function(){return{element:this.element(),actionable_element:this.actionable_element(),modifier:this.modifier(),actionable_modifier:this.actionable_modifier(),source:this,data:this.data,page_coords:f.coords,underneath:this.__underneath}},__triggerEvent:function(a){this.trigger(a,this.__eventData())},__triggerDomEvent:function(a){var b=this.__eventData(),e=c.elementFromPoint(b.page_coords.x,b.page_coords.y,this.actionable_element());e&&d.dispatchElementEvent(e,"drag-"+a,b)},__triggerDomMove:function(){var a=this.__eventData(),b=c.elementFromPoint(a.page_coords.x,a.page_coords.y,this.actionable_element());b&&(this.__old_coords&&this.__underneath&&this.__underneath!=b&&(d.dispatchPointsSeparatorEvent(b,"drag-enter",a.page_coords,this.__old_coords,a),d.dispatchPointsSeparatorEvent(this.__underneath,"drag-leave",this.__old_coords,a.page_coords,a)),d.dispatchElementEvent(b,"drag-hover",a)),this.__underneath=b,this.__old_coords=a.page_coords}}})}),a.define("module:Interactions.DragStates.Idle",["module:Interactions.State"],function(a,b){return a.extend({scoped:b},{_white_list:["Dragging"],trigger:function(a){this.parent().__triggerEvent(a)},triggerDom:function(a){this.parent().__triggerDomEvent(a)},triggerDomMove:function(){this.parent().__triggerDomMove()}})}),a.define("module:Interactions.DragStates.Dragging",["module:Interactions.DragStates.Idle","module:Hardware.MouseCoords","module:Elements.ElementModifier","module:Events.Mouse","browser:Dom"],function(a,b,c,d,e,f){return a.extend({scoped:f},{_white_list:["Stopping"],_persistents:["initial_element_coords","cloned_element","cloned_modifier","placeholder_cloned_element"],_start:function(){var a=this.parent().options();if(this._page_coords=b.coords,a.clone_element){var f=e.elementOffset(this.element()),g=e.elementDimensions(this.element());this._initial_element_coords={x:f.left,y:f.top};var h=this.element().style.zIndex,i=g.width,j=g.height;a.drag_original_element?(this._placeholder_cloned_element=this.element().cloneNode(!0),this.element().replaceWith(this._placeholder_cloned_element),this._cloned_element=this._placeholder_cloned_element):this._cloned_element=this.element().cloneNode(!0),this._cloned_modifier=new c(this._cloned_element),this._cloned_modifier.css("position","absolute"),this._cloned_modifier.css("width",i+"px"),this._cloned_modifier.css("height",j+"px"),this._cloned_modifier.css("zIndex",h+1),this._cloned_modifier.css("left",this._initial_element_coords.x+"px"),this._cloned_modifier.css("top",this._initial_element_coords.y+"px"),document.body.appendChild(this._cloned_element)}else{var k=this.parent().modifier();if(k.css("position","relative"),this._initial_element_coords={},a.draggable_x){var l=k.css("left");"auto"!==l&&l||k.css("left","0px"),this._initial_element_coords.x=parseInt(k.css("left"),10)}if(a.draggable_y){var m=k.css("top");"auto"!==m&&m||k.css("top","0px"),this._initial_element_coords.y=parseInt(k.css("top"),10)}}this.trigger("start"),this.on(document.body,d.moveEvent(),this.__dragging),a.stop_event&&this.on(document.body,a.stop_event,function(){a.droppable&&this.triggerDom("drop"),"next"in this&&this.next("Stopping",{released:!0})});var n=this.parent().actionable_modifier();this._drag_coords={left:parseInt(n.css("left"),10),top:parseInt(n.css("top"),10)}},__dragging:function(a){a.preventDefault();var b=d.pageCoords(a),c={x:b.x-this._page_coords.x,y:b.y-this._page_coords.y};this._page_coords=b;var e=this.parent().actionable_modifier();this._drag_coords.left+=c.x,this._drag_coords.top+=c.y;var f=this.options().snappable(this._drag_coords.left,this._drag_coords.top);this.options().draggable_x&&e.css("left",f.left+"px"),this.options().draggable_y&&e.css("top",f.top+"px"),this.trigger("move"),this.options().classes&&this.options().classes["move.actionable_modifier"]&&this.parent().actionable_modifier().csscls(this.options().classes["move.actionable_modifier"],!0),
this.options().classes&&this.options().classes["move.modifier"]&&this.parent().modifier().csscls(this.options().classes["move.modifier"],!0),this.triggerDomMove()}})}),a.define("module:Interactions.DragStates.Stopping",["module:Interactions.DragStates.Idle","module:Elements.DefaultAnimator"],function(a,b,c){return a.extend({scoped:c},function(a){return{_white_list:["Idle"],_locals:["initial_element_coords","cloned_element","cloned_modifier","immediately","released","placeholder_cloned_element"],_immediately:null,_start:function(){this.trigger("stopping"),this.triggerDom("stop");var a=this.options();if(!a.revertable||this._immediately)return this._released&&this.trigger("release"),void this.next("Idle");var c={};a.draggable_x&&(c.left=this._initial_element_coords.x+"px"),a.draggable_y&&(c.top=this._initial_element_coords.y+"px"),this.__animation=new b(this.parent().actionable_element(),{styles:c},function(){this.__animation&&this.next("Idle")},this),this._released&&this.trigger("release")},_end:function(){if(this.__animation){var b=this.__animation;this.__animation=null,b.complete()}this._cloned_modifier&&(this._cloned_modifier.revert(),this._cloned_modifier.destroy()),this._cloned_element&&(this._placeholder_cloned_element&&this._placeholder_cloned_element.replaceWith(this._cloned_element),this._cloned_element.parentNode.removeChild(this._cloned_element)),this.parent().modifier().revert(),this.trigger("stop"),a._end.call(this)}}})}),a.define("module:Interactions.Drop",["module:Interactions.ElementInteraction","base:Objs","module:Elements.ElementModifier","module:Interactions.DropStates","browser:Dom"],["module:Interactions.DropStates.Disabled","module:Interactions.DropStates.Idle","module:Interactions.DropStates.Hover","module:Interactions.DropStates.InvalidHover","module:Interactions.DropStates.Dropping"],function(a,b,c,d,e,f){return a.extend({scoped:f},function(a){return{constructor:function(e,f,g){f=b.extend({droppable:function(){return!0},context:this,bounding_box:function(a){return a},snapableX:!1,snapableY:!1},f),a.constructor.call(this,e,f,d),this._host.initialize("Idle"),this._modifier=new c(this.element()),this.data=g},destroy:function(){this._modifier.revert(),this._modifier.destroy(),a.destroy.call(this)},_enable:function(){this._host.state().next("Idle")},_disable:function(){this._host.state().next("Disabled")},modifier:function(){return this._modifier},__eventData:function(){return{element:this.element(),modifier:this.modifier(),target:this,data:this.data,source:this._host.state()._drag_source?this._host.state()._drag_source:null}},__triggerEvent:function(a){this.trigger(a,this.__eventData())},droppable:function(a){return this._options.droppable.call(this._options.context,a,this)},_is_hovering:function(a){if(!a.source.options().droppable)return!1;var b=e.elementBoundingBox(this.element());b=this._options.bounding_box.call(this._options.context,b);var c=a.page_coords;return b.left<=c.x&&c.x<=b.right&&b.top<=c.y&&c.y<=b.bottom}}})}),a.define("module:Interactions.DropStates.Disabled",["module:Interactions.State"],function(a,b){return a.extend({scoped:b},{_white_list:["Idle"],trigger:function(a){this.parent().__triggerEvent(a)}})}),a.define("module:Interactions.DropStates.Idle",["module:Interactions.DropStates.Disabled"],function(a,b){return a.extend({scoped:b},{_white_list:["Hover","InvalidHover","Disabled"],_start:function(){this.on(this.element(),"drag-hover",function(a){if(this.parent()._enabled){var b=a.detail;this.parent()._is_hovering(b)&&this.next(this.parent().droppable(b)?"Hover":"InvalidHover",{drag_source:b})}})}})}),a.define("module:Interactions.DropStates.Hover",["module:Interactions.DropStates.Disabled","browser:Dom"],function(a,b,c){return a.extend({scoped:c},function(a){return{_white_list:["Idle","Disabled","Dropping"],_persistents:["drag_source"],_start:function(){this.trigger("hover"),this.options().classes&&this.options().classes["hover.modifier"]&&this.parent().modifier().csscls(this.options().classes["hover.modifier"],!0),this.on(this.element(),"drag-hover",function(a){this._drag_source=a.detail,this._dragSnap(this.element(),this._drag_source.actionable_element),this.parent()._is_hovering(this._drag_source)||this.next("Idle")}),this.on(this.element(),"drag-stop drag-leave",function(a){this._drag_source=a.detail,this.next("Idle")}),this.on(this.element(),"drag-drop",function(a){this._drag_source=a.detail,this.next("Dropping")})},_end:function(){this.trigger("unhover"),this.parent().modifier().revert(),a._end.call(this)},_dragSnap:function(a,c){if(this.options().snapableX||this.options().snapableY){var d=b.elementOffset(a),e=b.elementDimensions(a),f=b.elementOffset(c),g=b.elementDimensions(c),h={left:f.left+g.width/2,top:f.top+g.height/2},i={left:d.left+e.width/2,top:d.top+e.height/2};this.options().snapableX&&Math.abs(h.left-i.left)<=this.options().snapableX&&(c.style.left=i.left-g.width/2+"px"),this.options().snapableY&&Math.abs(h.top-i.top)<=this.options().snapableY&&(c.style.top=i.top-g.height/2+"px")}}}})}),a.define("module:Interactions.DropStates.InvalidHover",["module:Interactions.DropStates.Disabled"],function(a,b){return a.extend({scoped:b},function(a){return{_white_list:["Idle","Disabled"],_persistents:["drag_source"],_start:function(){this.trigger("hover-invalid"),this.on(this.element(),"drag-hover",function(a){this._drag_source=a.detail,this.parent()._is_hovering(this._drag_source)||this.next("Idle")}),this.on(this.element(),"drag-drop drag-stop drag-leave",function(a){this._drag_source=a.detail,this.next("Idle")})},_end:function(){this.trigger("unhover"),this.parent().modifier().revert(),a._end.call(this)}}})}),a.define("module:Interactions.DropStates.Dropping",["module:Interactions.DropStates.Disabled"],function(a,b){return a.extend({scoped:b},{_white_list:["Idle","Disabled"],_persistents:["drag_source"],_start:function(){this._drag_source.source.dropped(this.parent()),this.trigger("dropped"),this.next("Idle")}})}),a.define("module:Interactions.Droplist",["module:Interactions.ElementInteraction","base:Objs","module:Interactions.DroplistStates","browser:Dom"],["module:Interactions.DroplistStates.Disabled","module:Interactions.DroplistStates.Idle","module:Interactions.DroplistStates.Hover","module:Interactions.DroplistStates.Dropping"],function(a,b,c,d,e){return a.extend({scoped:e},function(a){return{constructor:function(e,f,g){f=b.extend({droppable:function(){return!0},context:this,bounding_box:function(a){return a},floater:null},f),a.constructor.call(this,e,f,c),this._host.initialize("Idle"),this.data=g,this._floater=d.unbox(this._options.floater),this._floater.style.display="none"},destroy:function(){this._host.destroy(),a.destroy.call(this)},_enable:function(){this._host.state().next("Idle")},_disable:function(){this._host.state().next("Disabled")},__eventData:function(){return{index:d.elementIndex(this._floater),element:this.element(),target:this,data:this.data,source:this._host.state()._drag_source?this._host.state()._drag_source:null}},__triggerEvent:function(a){this.trigger(a,this.__eventData())},droppable:function(a){return this._options.droppable.call(this._options.context,a,this)},__update_floater:function(a){this._floater.style.display="none";var b=a.page_coords,c=d.childContainingElement(this.element(),a.underneath);if(c){if(c===this._floater)return void(this._floater.style.display="");var e=d.elementBoundingBox(c);e=this._options.bounding_box.call(this._options.context,e),e.top<=b.y&&b.y<=e.bottom||(this._floater.style.display="",b.y<e.top?d.elementInsertBefore(this._floater,c):d.elementInsertAfter(this._floater,c))}},insertAt:function(a,b){d.elementInsertAt(a,this.element(),b)}}})}),a.define("module:Interactions.DroplistStates.Disabled",["module:Interactions.State"],function(a,b){return a.extend({scoped:b},{_white_list:["Idle"],trigger:function(a){this.parent().__triggerEvent(a)}})}),a.define("module:Interactions.DroplistStates.Idle",["module:Interactions.DroplistStates.Disabled"],function(a,b){return a.extend({scoped:b},{_white_list:["Hover","Disabled"],_start:function(){this.on(this.element(),"drag-hover",function(a){var b=a.detail;this.parent().droppable(b)&&this.next("Hover")})}})}),a.define("module:Interactions.DroplistStates.Hover",["module:Interactions.DroplistStates.Disabled"],function(a,b){return a.extend({scoped:b},function(a){return{_white_list:["Idle","Disabled","Dropping"],_persistents:["drag_source"],_start:function(){this.trigger("hover"),this.on(this.element(),"drag-hover",function(a){this._drag_source=a.detail,this.parent().__update_floater(this._drag_source)}),this.on(this.element(),"drag-stop drag-leave",function(a){this._drag_source=a.detail,this.next("Idle")}),this.on(this.element(),"drag-drop",function(a){this._drag_source=a.detail,this.parent().__update_floater(this._drag_source),this.next("none"==this.parent()._floater.style.display?"Idle":"Dropping")})},_end:function(){this.trigger("unhover"),this.parent()._floater.style.display="none",a._end.call(this)}}})}),a.define("module:Interactions.DroplistStates.Dropping",["module:Interactions.DroplistStates.Disabled"],function(a,b){return a.extend({scoped:b},{_white_list:["Idle","Disabled"],_persistents:["drag_source"],_start:function(){this._drag_source.source.dropped(this.parent()),this.trigger("dropped"),this.next("Idle")}})}),a.define("module:Interactions.Infinitescroll",["module:Interactions.Scroll","base:Objs","base:Async","module:Interactions.InfinitescrollStates","browser:Dom"],["module:Interactions.InfinitescrollStates.Idle","module:Interactions.InfinitescrollStates.Scrolling","module:Interactions.InfinitescrollStates.ScrollingTo"],function(a,b,c,d,e,f){return a.extend({scoped:f},function(a){return{constructor:function(f,g,h){g=b.extend({append_count:25,prepend_count:25,height_factor:3,whitespace_bottom:!1,context:null,append:null,prepend:null},g),a.constructor.call(this,f,g,h,d),this._can_append=!!g.append,this._can_prepend=!!g.prepend,this._extending=!1,g.prepend&&this.options().whitespace&&(this.__top_white_space=this._whitespaceCreate(),e.elementPrependChild(this.itemsElement(),this.__top_white_space)),this.options().whitespace_bottom&&(this.__bottom_white_space=this._whitespaceCreate(),this.itemsElement().appendChild(this.__bottom_white_space)),c.eventually(function(){this.reset(!0)},this)},append:function(a){var b=this.options();if(this._can_append&&!this._extending){this._extending=!0;var c=this;b.append.call(b.context,a||b.append_count,function(a,b){c.__bottom_white_space&&c.itemsElement().appendChild(c.__bottom_white_space),c._extending=!1,c._can_append=b,c.appended(a)})}},appendNeeded:function(){var a=this.element().scrollHeight,b=this.element().clientHeight,c=a-(this.element().scrollTop+b)-this._whitespaceGetHeight(this.__bottom_white_space);return c<this.options().height_factor*b},prependNeeded:function(){if(!this.options().prepend)return!1;var a=this.element().clientHeight,b=this.element().scrollTop-this._whitespaceGetHeight(this.__top_white_space);return b<this.options().height_factor*a},prepend:function(a){var b=this.options();if(this._can_prepend){this._extending=!0;var c=this;b.prepend.call(b.context,a||b.prepend_count,function(a,b){c.__top_white_space&&e.elementPrependChild(c.itemsElement(),c.__top_white_space),c._extending=!1,c._can_prepend=b,c.prepended(a)})}},appended:function(a){},prepended:function(a){var b=this.itemsElement().children[1],c=this.itemsElement().children[a],d=e.elementOffset(c).top-e.elementOffset(b).top+e.elementDimensions(c).height;this.scrolling()?this._whitespaceSetHeight(this.__top_white_space,this._whitespaceGetHeight(this.__top_white_space)-d):this.element().scrollTop=this.element().scrollTop-d},extendFix:function(){this.scrollingDirection()?this.appendNeeded()&&this.append():this.prependNeeded()&&this.prepend()},_whitespaceFix:function(){if(this.__top_white_space){var a=this._whitespaceGetHeight(this.__top_white_space);this._whitespaceSetHeight(this.__top_white_space,this.options().whitespace),this.element().scrollTop=Math.max(this.options().whitespace,this.element().scrollTop+this.options().whitespace-a)}},reset:function(a){this._whitespaceSetHeight(this.__bottom_white_space,this.options().whitespace),this.options().prepend&&(this._whitespaceSetHeight(this.__top_white_space,this.options().whitespace),this.element().scrollTop=this.options().whitespace+(a?this.element().scrollTop:0),this.__top_white_space.clientHeight||c.eventually(this.reset,this,100))}}})}),a.define("module:Interactions.InfinitescrollStates.Idle",["module:Interactions.ScrollStates.Idle"],function(a,b){return a.extend({scoped:b},{})}),a.define("module:Interactions.InfinitescrollStates.Scrolling",["module:Interactions.ScrollStates.Scrolling"],function(a,b){return a.extend({scoped:b},{_scroll:function(){this.parent().extendFix()},_scrollend:function(){this.parent()._whitespaceFix()}})}),a.define("module:Interactions.InfinitescrollStates.ScrollingTo",["module:Interactions.ScrollStates.ScrollingTo"],function(a,b){return a.extend({scoped:b},{_scroll:function(){this.parent().extendFix()},_scrollend:function(){this.parent()._whitespaceFix()}})}),a.define("module:Interactions.ElementInteraction",["base:Class","base:Events.EventsMixin","module:Hardware.MouseCoords","base:Async","base:States.Host","base:Ids","base:Objs","base:Classes.ClassRegistry","browser:Dom","browser:Events"],function(a,b,c,d,e,f,g,h,i,j,k){return a.extend({scoped:k},[b,function(a){return{constructor:function(b,f,g){if(a.constructor.call(this),this._domEvents=new j,c.require(),this._element=i.unbox(b),this._enabled=!1,this._options=f||{},"enabled"in this._options){var k=this._options.enabled;delete this._options.enabled,k&&d.eventually(this.enable,this)}this._host=new e({stateRegistry:g?new h(g):null}),this._host.parent=this},__on:function(a,b,c,d){this._domEvents.on(i.unbox(a),b,c,d||this)},destroy:function(){this._domEvents.destroy(),this.disable(),this._host.destroy(),c.unrequire(),a.destroy.call(this)},enable:function(){this._enabled||this.destroyed()||(this._enabled=!0,this._enable())},disable:function(){this._enabled&&(this._enabled=!1,this._disable())},element:function(){return this._element},options:function(){return this._options},_enable:function(){},_disable:function(){}}}],{multiple:function(a,b,c,d){for(var e=0;e<a.length;++e){var f=new this(a[e],b);c&&c.call(d||f,f)}}})}),a.define("module:Interactions.State",["base:States.State","browser:Events","browser:Dom","base:Ids","base:Objs"],function(a,b,c,d,e,f){return a.extend({scoped:f},function(a){return{constructor:function(){a.constructor.apply(this,arguments),this._domEvents=this.auto_destroy(new b)},parent:function(){return this.host.parent},element:function(){return this.parent().element()},options:function(){return this.parent().options()},on:function(a,b,d,e){this._domEvents.on(c.unbox(a),b,function(){this.destroyed()||d.apply(e||this,arguments)},this)},_end:function(){this._domEvents.clear()}}})}),a.define("module:Interactions.Loopscroll",["module:Interactions.Scroll","module:Interactions.LoopscrollStates","browser:Dom"],["module:Interactions.LoopscrollStates.Idle","module:Interactions.LoopscrollStates.Scrolling","module:Interactions.LoopscrollStates.ScrollingTo"],function(a,b,c,d){return a.extend({scoped:d},function(a){return{constructor:function(d,e,f){a.constructor.call(this,d,e,f,b),this.__top_white_space=this._whitespaceCreate(),c.elementPrependChild(this.itemsElement(),this.__top_white_space),this.__bottom_white_space=this._whitespaceCreate(),this.itemsElement().appendChild(this.__bottom_white_space),this.reset(!0)},_rotateFix:function(){var a=this.itemsElement().children,b=this._whitespaceGetHeight(this.__top_white_space),d=this._whitespaceGetHeight(this.__bottom_white_space),e=this.element().scrollHeight,f=this.element().clientHeight,g=e-b-d,h=this.element().scrollTop,i=a.length-2,j=(h-b)/g*i,k=(g-(h-b)-f)/g*i;if(k-1>j)for(;k-1>j;){var l=a[a.length-2];c.elementInsertAfter(l,this.__top_white_space),b-=c.elementDimensions(l).height,this._whitespaceSetHeight(this.__top_white_space,b),k--,j++}else if(j-1>k)for(;j-1>k;){var m=a[1];c.elementInsertBefore(m,this.__bottom_white_space),b+=c.elementDimensions(m).height,this._whitespaceSetHeight(this.__top_white_space,b),k++,j--}},_whitespaceFix:function(){this._whitespaceSetHeight(this.__bottom_white_space,this.options().whitespace);var a=this._whitespaceGetHeight(this.__top_white_space);this._whitespaceSetHeight(this.__top_white_space,this.options().whitespace),this.element().scrollTop=this.element().scrollTop+this.options().whitespace-a},scrollToElement:function(b,c){a.scrollToElement.call(this,b,c)},reset:function(a){this._whitespaceSetHeight(this.__bottom_white_space,this.options().whitespace),this._whitespaceSetHeight(this.__top_white_space,this.options().whitespace),this.element().scrollTop=this.options().whitespace+(a?this.element().scrollTop:0)}}})}),a.define("module:Interactions.LoopscrollStates.Idle",["module:Interactions.ScrollStates.Idle"],function(a,b){return a.extend({scoped:b},{})}),a.define("module:Interactions.LoopscrollStates.Scrolling",["module:Interactions.ScrollStates.Scrolling"],function(a,b){return a.extend({scoped:b},{_scroll:function(){this.parent()._rotateFix()},_scrollend:function(){this.parent()._whitespaceFix()}})}),a.define("module:Interactions.LoopscrollStates.ScrollingTo",["module:Interactions.ScrollStates.ScrollingTo"],function(a,b){return a.extend({scoped:b},{_scroll:function(){this.parent()._rotateFix()},_scrollend:function(){this.parent()._whitespaceFix()}})}),a.define("module:Interactions.Pinch",["module:Interactions.ElementInteraction","module:Interactions.PinchStates"],["module:Interactions.PinchStates.Idle","module:Interactions.PinchStates.Pinching"],function(a,b,c){return a.extend({scoped:c},function(a){return{constructor:function(c,d,e){a.constructor.call(this,c,d,b),this._host.initialize("Idle"),this.data=e},_disable:function(){this.stop()},start:function(){this._enabled&&this._host.state().next("Pinching")},stop:function(){this._enabled&&this._host.state().next("Idle")},__eventData:function(){var a=this._host.state();return{element:this.element(),source:this,data:this.data,initial:a._initial_coords,delta_last:a._delta_last}},__triggerEvent:function(a){this.trigger(a,this.__eventData())}}})}),a.define("module:Interactions.PinchStates.Idle",["module:Interactions.State","module:Events.Mouse"],function(a,b,c){return a.extend({scoped:c},{_white_list:["Pinching"],trigger:function(a){this.parent().__triggerEvent(a)},_start:function(){this.on(this.element(),"touchstart",function(a){this.parent()._enabled&&a.touches&&2==a.touches.length&&this.next("Pinching",{initial_coords:b.clientCoords(a,!0)})})}})}),a.define("module:Interactions.PinchStates.Pinching",["module:Interactions.PinchStates.Idle","module:Events.Mouse"],function(a,b,c){return a.extend({scoped:c},function(a){return{_white_list:["Idle"],_persistents:["initial_coords","current_coords"],_initial_coords:null,_start:function(){this._last_coords=null,this._current_coords=this._initial_coords,this.trigger("pinchstart"),this.on(this.element(),"touchmove",function(a){return a.touches&&2==a.touches.length?void this.__pinching(a):void this.next("Idle")}),this.on(this.element(),"touchend",function(){this.next("Idle")})},_end:function(){this.trigger("pinchstop"),a._end.call(this)},__pinching:function(a){a.preventDefault(),this._last_coords=this._current_coords,this._current_coords=b.clientCoords(a,!0),this.__compute_values(),this.trigger("pinch")},__compute_values:function(){var a=function(a,b){return a[0][b]<=a[1][b]?a[0][b]:a[1][b]},b=function(a,b){return a[0][b]>=a[1][b]?a[0][b]:a[1][b]};this._delta_last={x:a(this._last_coords,"x")-a(this._current_coords,"x")+b(this._current_coords,"x")-b(this._last_coords,"x"),y:a(this._last_coords,"y")-a(this._current_coords,"y")+b(this._current_coords,"y")-b(this._last_coords,"y")}}}})}),a.define("module:Interactions.Scroll",["module:Interactions.ElementInteraction","base:Objs","browser:Dom","module:Interactions.ScrollStates"],function(a,b,c,d,e){return a.extend({scoped:e},function(a){return{constructor:function(e,f,g,h){h=h||d,f=b.extend({discrete:!1,currentCenter:!1,currentTop:!0,scrollEndTimeout:50,whitespace:1e4,display_type:"",elementMargin:20,enable_scroll_modifier:"scroll"},f),a.constructor.call(this,e,f,h),this._itemsElement=c.unbox(f.itemsElement||e),this._disableScrollCounter=0,this._host.initialize("Idle"),this._scrollingDirection=!0,this._lastScrollTop=null,this.__on(this.element(),"scroll",function(){var a=this.element().scrollTop;null!==this._lastScrollTop&&(this._scrollingDirection=a>=this._lastScrollTop),this._lastScrollTop=a})},_whitespaceType:function(){return this.options().display_type?this.options().display_type:(this.element().style.display||"").toLowerCase().indexOf("flex")>=0?"flex":"default"},_whitespaceCreate:function(){var a=document.createElement("whitespace"),b=this._whitespaceType();return"flex"==b?(a.style.display="-ms-flexbox",a.style.display="-webkit-flex",a.style.display="flex"):a.style.display="block",a},_whitespaceGetHeight:function(a){return a?c.elementDimensions(a).height:0},_whitespaceSetHeight:function(a,b){if(a){var c=this._whitespaceType();"flex"==c?(a.style["-webkit-flex"]="0 0 "+b+"px",a.style["-ms-flex"]="0 0 "+b+"px",a.style.flex="0 0 "+b+"px"):a.style.height=b+"px"}},itemsElement:function(){return this._itemsElement},scrollingDirection:function(){return this._scrollingDirection},currentElement:function(){for(var a=c.elementOffset(this.element()),b=this._options.currentTop?this._options.elementMargin:this.element().clientHeight-1-this._options.elementMargin,d=this.element().clientWidth/2,e=c.elementFromPoint(a.left+d,a.top+b);e&&e.parentNode!=this.itemsElement();)e=e.parentNode;if(!e)return null;if(!this._options.currentCenter)return e;if(this._options.currentTop){var f=a.top-c.elementOffset(e).top;f>c.elementDimensions(e).height/2&&(e=e.nextElementSibling)}else{var g=a.top+b-c.elementOffset(e).top;g<c.elementDimensions(e).height/2&&(e=e.previousElementSibling)}return e},scrollTo:function(a,b){var c=a-(this._options.currentTop?0:this.element().clientHeight-1);b=b||{},b.scroll_top=c,this._host.state().next("ScrollingTo",b)},scrollToElement:function(a,b){a=c.unbox(a);var d=c.elementOffset(a).top-c.elementOffset(this.element()).top+this.element().scrollTop;this.scrollTo(d+(this._options.currentTop?0:c.elementDimensions(a).height-1),b)},disableScroll:function(){0===this._disableScrollCounter&&(this.element().style.overflow="hidden"),this._disableScrollCounter++},enableScroll:function(){this._disableScrollCounter--,0===this._disableScrollCounter&&(this.element().style.overflow=this._options.enable_scroll_modifier)},scrolling:function(){return"Idle"!=this._host.state().state_name()}}})}),a.define("module:Interactions.ScrollStates.Idle",["module:Interactions.State"],function(a,b){return a.extend({scoped:b},{itemsElement:function(){return this.parent().itemsElement()},_start:function(){this.on(this.element(),"scroll",function(){this.next("Scrolling")})}})}),a.define("module:Interactions.ScrollStates.Scrolling",["module:Interactions.ScrollStates.Idle"],function(a,b){return a.extend({scoped:b},function(a){return{_start:function(){this.__timer=null,this.on(this.element(),"scroll",function(){this._scroll(),this.parent().trigger("scroll"),clearTimeout(this.__timer);var a=this.options(),b=this;this.__timer=setTimeout(function(){b.parent().disableScroll(),b.parent().trigger("scrollend"),b._scrollend();var c=b.parent().currentElement();a.discrete&&c?b.parent().scrollToElement(c,{animate:!0,abortable:!0}):b.eventualNext("Idle")},a.scrollEndTimeout)})},_scroll:function(){},_scrollend:function(){},_end:function(){clearTimeout(this.__timer),this.parent().enableScroll(),a._end.call(this)}}})}),a.define("module:Interactions.ScrollStates.ScrollingTo",["module:Interactions.ScrollStates.Idle","module:Elements.DefaultAnimator"],function(a,b,c){return a.extend({scoped:c},function(a){return{_locals:["scroll_top","animate","abortable"],_scroll_top:null,_abortable:null,_start:function(){this._abortable||this.parent().disableScroll(),this.parent().trigger("scrollto"),this.on(this.element(),"scroll",function(){this._scroll()}),this._abortable&&(this.on(this.element(),"wheel",function(){this._moved=!0,this._abort()}),this.on(this.element(),"touchstart",function(){this._moved=!0,this._abort()})),this.suspend(),this._animate?(this._animation=new b(this.element(),{styles:{scrollTop:this._scroll_top}},this._finished,this),this._animation.start()):(this.element().scrollTop=this._scroll_top,this._scroll(),this._finished())},_abort:function(){this._aborted||(this._aborted=!0,this._animate?(this._animation&&this._animation.complete(),this._animation=null):this._finished())},_finished:function(){this.parent().trigger("scrolltoend"),this.destroyed()||(this._scrollend(),this._transitioning?this.eventualResume():(this.resume(),this.eventualNext(this._moved?"Scrolling":"Idle")))},_scroll:function(){},_scrollend:function(){},_transition:function(){this._abort()},_end:function(){this._abortable||this.parent().enableScroll(),this._animation&&this._animation.weakDestroy(),a._end.call(this)}}})}),a.define("module:Interactions.Shiftscroll",["module:Interactions.Scroll","base:Async","browser:Dom"],function(a,b,c,d){return a.extend({scoped:d},function(a){return{constructor:function(){a.constructor.apply(this,arguments),this.__bottom_white_space=this._whitespaceCreate(),this.itemsElement().appendChild(this.__bottom_white_space),this._whitespaceFix(),b.eventually(this._whitespaceFix,this)},_whitespaceFix:function(){var a=this.element().clientHeight,b=c.elementDimensions(this.itemsElement().firstElementChild).height;this._whitespaceSetHeight(this.__bottom_white_space,a-b)}}})})}).call(Scoped);